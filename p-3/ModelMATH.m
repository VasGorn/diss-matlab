%-------------object control--------------
%--- a1*D^(1+mu)*I + a0*D^mu*I + I = K ---
% clear
% 24 V
% uv = 24;
% b0 = 1;
% a1 = 0.003332; %
% a0 =  0.65161;
% k =  47.78579; %
% mu = 0.30313;

% 20 V
% uv = 20;
% b0 = 1;
% a1 = 0.0025348; %
% a0 =  0.5770967;
% k =  48.55552; %
% mu = 0.326614;

% 16 V
% uv = 16;
% b0 = 1;
% a1 = 0.00180974; %
% a0 =  0.526774;
% k =  52.63237; %
% mu = 0.372015;

% 12 V
% uv = 12;
% b0 = 1;
% a1 = 0.001622; %
% a0 =  0.546322;
% k =  62.65094; %
% mu = 0.41898;

% 8 V
% uv = 8;
% b0 = 1;
% a1 = 0.001187; %
% a0 =  0.40193;
% k =  63.9522; %
% mu = 0.49647;

% 4 V
% uv = 4;
% b0 = 1;
% a1 = 0.002178; %
% a0 =  0.31677;
% k =  67.5310; %
% mu = 0.5802;

%=============================================
mu = 0.42;
b0 = 1;
% 24 V
uv = 24;
a1 = 0.00142; %
a0 = 0.2364516;
k = 32.46734; %

% 20 V
% uv = 20;
% a1 = 0.001112; %
% a0 = 0.343870;
% k = 41.71000; %

% 16 V
% uv = 16;
% a1 = 0.0011305; %
% a0 = 0.404838;
% k = 48.99223; %

% 12 V
% uv = 12;
% a1 = 0.001496; %
% a0 = 0.481290;
% k = 57.7992; %

% 8 V
% uv = 8;
% a1 = 0.002795; %
% a0 = 0.565483;
% k = 69.2641; %

% 4 V
% uv = 4;
% a1 = 0.006661; %
% a0 = 0.50161;
% k = 69.0880; %

dt = 1e-5;

znam = a1*dt + a0*dt*dt;
hnK = k*dt*dt/znam;
hnA1 = (a1*dt)/znam;
hnB0 = (b0*dt*dt)/znam;

n_point = 7000;

x(n_point) = 0;
dy(n_point) = 0;
f1(n_point) = 0;
y(n_point) = 0;
fmu1(n_point) = 0;

sum = 0;
time = (0:n_point-1)*dt;

for i= 1:n_point
    x(i)= uv;
    
    dy(i) = hnK*x(i);
    if i > 1
        dy(i) = dy(i) + hnA1*dy(i-1) - hnB0*y(i-1);
    end
    
    f1(i) = dy(i);
    
    fmu1(i) = f1(i)*(dt^mu)/gamma(1+mu);
    Imu1 = 0;
    for j=1:i
        Imu1 = Imu1 + fmu1(i-j+1)*(j^mu -(j-1)^mu);
    end
    
%     if abs(Imu1) > 10
%         Imu1 = 10*sign(Imu1);
%     end
    
    y(i) = Imu1;
    
    %er = (y(i) - y2(i))^2;
    %sum = sum + er;
end
